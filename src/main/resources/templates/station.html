<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, shrink-to-fit=no">
  <title th:text="${station.name} + ' | eRadios.in - Indian Online Radio Streaming'">Station - eRadios.in</title>
  <!-- Bootstrap CSS -->
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
  <!-- Google Fonts -->
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@600;700&family=Roboto&display=swap"
    rel="stylesheet">
  <!-- Font Awesome for Icons -->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
  <!-- Custom CSS -->
  <link rel="stylesheet" th:href="@{/css/styles.css}">
  <link rel="icon" href="/images/icon.png" type="image/x-icon">

  <!-- Mobile-First Custom Styles -->
  <style>
    a {
      text-decoration: none;
      color: inherit;
    }

    a:hover {
      color: #bd9208;
    }

    h1 {
      font-family: 'Poppins', sans-serif;
      font-weight: 700;
      font-size: 1.8rem;
      color: #1a1a2e;
      /* margin-bottom: 0.5rem; */
      text-align: left;
    }

    h2 {
      font-family: 'Poppins', sans-serif;
      font-weight: 600;
      font-size: 1.2rem;
      color: #1a1a2e;
      margin-top: 1.5rem;
      margin-bottom: 0.5rem;
    }

    p {
      font-family: 'Roboto', sans-serif;
      font-size: 0.9rem;
      line-height: 1.6;
      margin-bottom: 1rem;
    }

    .station-logo {
      width: 150px;
      height: 150px;
      object-fit: contain;
      aspect-ratio: 1/1;
      margin: 0 auto 1rem;
    }

    .related-station-logo {
      width: 40px;
      height: 40px;
      object-fit: contain;
      aspect-ratio: 1/1;
    }

    .tag {
      background-color: #383838b0;
      color: #fff;
      padding: 0.3rem 0.6rem;
      border-radius: 12px;
      font-size: 0.8rem;
      display: inline-block;
      margin: 0.2rem;
    }

    .related-station-card {
      transition: transform 0.3s ease-in-out;
    }

    .related-station-card:hover {
      transform: scale(1.03);
      background-color: rgba(128, 128, 128, 0.1);
    }

    .navbar-brand i {
      color: #bd9208;
    }

    hr.section-divider {
      border: 0;
      border-top: 1px solid #bd9208;
      margin: 1.5rem 0;
    }

    .play-icon {
      font-size: 2.5rem;
      color: #000;
      transition: color 0.3s ease-in-out;
      cursor: pointer;
    }

    .play-icon:hover {
      color: #664e05;
    }

    .container {
      padding: 0 1rem;
    }

    .main-section {
      padding: 2rem;
      box-shadow: 0 8px 20px rgba(0, 0, 0, 0.1);
      border-radius: 15px;
      background-color: #ffffff;
    }

    #player-container{
      background: linear-gradient(0deg, #bd9208, white);
    }

    /* Adjustments for larger screens */
    @media (min-width: 576px) {
      h1 {
        font-size: 1.7rem;
        text-align: left;
      }

      h2 {
        font-size: 1.3rem;
      }

      p {
        font-size: 1rem;
      }

      .station-logo {
        width: 150px;
        height: 150px;
        box-shadow: #aaa 0px 0px 3px;
        margin: 0 1rem 0 0;
        padding: 5px;
      }

      .related-station-logo {
        width: 50px;
        height: 50px;
        box-shadow: #aaa 0px 0px 3px;
        padding: 2px;
      }

      .play-icon {
        font-size: 3rem;
      }

      .ad-space {
        max-width: 468px;
        min-height: 60px;
      }

      .main-section {
        padding: 1.5rem;
      }
    }

    @media (min-width: 768px) {
      h1 {
        font-size: 2.5rem;
        margin-bottom: 0;
      }

      h2 {
        font-size: 1.5rem;
      }

      .container {
        padding: 0 1.5rem;
      }

      .ad-space {
        max-width: 728px;
        min-height: 90px;
      }

      .play-icon {
        font-size: 4rem;
      }

      .main-section {
        padding: 1.5rem;
      }
    }

    @media (min-width: 992px) {
      .container {
        max-width: 900px;
      }

      .main-section {
        padding: 2rem;
      }
    }
  </style>
  <style>
    .description-container {
      position: relative;
    }

    .description-text {
      display: -webkit-box;
      -webkit-line-clamp: 2;
      line-clamp: 2;
      /* Limits text to 2 lines */
      -webkit-box-orient: vertical;
      overflow: hidden;
      text-overflow: ellipsis;
      transition: all 0.3s ease;
      text-align: justify;
      color: rgb(49, 49, 49);
    }

    .description-text.expanded {
      -webkit-line-clamp: unset;
      line-clamp: unset;
      /* Removes line clamp to show full text */
      overflow: visible;
    }

    .toggle-button {
      background: none;
      border: none;
      color: #0b55a3;
      cursor: pointer;
      padding: 5px 0;
      font-size: 1rem;
      font-weight: 500;
      text-decoration: none;
    }

    .toggle-button:hover {
      color: #0056b3;
    }
  </style>
  <!-- SEO Meta Tags -->
  <meta name="google-adsense-account" content="ca-pub-2939946349164066">
  <meta name="description" th:content="${station.metaDescription}">
  <meta name="keywords"
    th:content="'eRadios, ' + ${station.name} + ', online radio, live radio, radio streaming, music, news, entertainment, high-quality streaming, mobile-friendly, Indian stations'">
  <meta name="author" content="eRadios.in">
  <meta property="og:title" th:content="${station.name} + ' – Listen Live on eRadios.in'">
  <meta property="og:description" th:content="${station.metaDescription}">
  <meta property="og:type" content="music.radio_station">
  <meta property="og:url" th:content="@{/stations/{name}(name=${station.formattedName})}">
  <meta property="og:site_name" content="eRadios.in">
  <meta property="og:image" th:content="${station.favicon} ?: 'https://www.eradios.in/images/logo.png'">
  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:title" th:content="${station.name} + ' – Listen Live on eRadios.in'">
  <meta name="twitter:description" th:content="${station.metaDescription}">
  <meta name="twitter:image" th:content="${station.favicon} ?: 'https://www.eradios.in/images/logo.png'">
  <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-2939946349164066"
    crossorigin="anonymous"></script>
</head>

<body>
  <script>
    document.addEventListener('contextmenu', function (e) {
      e.preventDefault();
    });
    document.addEventListener('keydown', function (e) {
      // F12
      if (e.keyCode === 123) {
        e.preventDefault();
      }

      // Ctrl+Shift+I
      if (e.ctrlKey && e.shiftKey && e.keyCode === 73) {
        e.preventDefault();
      }

      // Ctrl+Shift+J (console)
      if (e.ctrlKey && e.shiftKey && e.keyCode === 74) {
        e.preventDefault();
      }

      // Ctrl+U (view source)
      if (e.ctrlKey && e.keyCode === 85) {
        e.preventDefault();
      }

      // Ctrl+Shift+C (inspect element)
      if (e.ctrlKey && e.shiftKey && e.keyCode === 67) {
        e.preventDefault();
      }
    });

  </script>
  <!-- Loader Overlay -->
  <div id="pageLoader" style="
    position:fixed;
    top:0;left:0;width:100vw;height:100vh;
    background:linear-gradient(135deg, #fffbe6 0%, #fff3cd 100%);
    z-index:9999;
    display:flex;
    align-items:center;
    justify-content:center;
    transition:opacity 0.4s;
  ">
    <div style="text-align:center;">
      <i class="fas fa-radiation fa-spin" style="font-size:8rem;color:#bd9208;"></i>
    </div>
  </div>

  <!-- Navigation Bar -->
  <nav class="navbar navbar-expand-lg navbar-dark bg-dark">
    <div class="container">
      <a class="navbar-brand" href="/"><i class="fas fa-radiation fa-spin fs-3 me-2"></i>eRadios.in</a>
      <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav"
        aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation">
        <span class="navbar-toggler-icon"></span>
      </button>
      <div class="collapse navbar-collapse" id="navbarNav">
        <ul class="navbar-nav ms-auto">
          <li class="nav-item">
            <a class="nav-link" href="/">Home</a>
          </li>
          <li class="nav-item">
            <a class="nav-link" href="/stations">Stations</a>
          </li>
          <li class="nav-item">
            <a class="nav-link" href="/contact">Contact</a>
          </li>
          <li class="nav-item">
            <a class="nav-link" href="/add-station"><i class="fas fa-plus-circle"></i></a>
          </li>
        </ul>
      </div>
    </div>
  </nav>

  <!-- Main Content -->
  <section>
    <div class="d-none"> <p th:text="${station.id}"></p>
    </div>
    <div class="container main-section mt-3" id="player-container">
      <!-- Station Details Section -->
      <div class="d-flex flex-column align-items-center">
        <img th:src="${station.favicon}" th:alt="${station.name} + ' Logo'"
          class="station-logo rounded border border-secondary border-2 mb-3">
        <div class="d-flex align-items-center justify-content-between w-100">
          <h1 th:text="${station.name}">Station Name</h1>
          <a href="javascript:void(0);" class="play-icon" id="play_btn">
            <i class="fas fa-play-circle"></i>
          </a>
        </div>
      </div>
    </div>

    <div class="container main-section mt-3">
      <!-- Description -->
      <div>
        <h2>Description</h2>
        <div class="description-container">
          <div class="description-text" th:utext="${station.about}" id="descriptionText">
            Station description goes here.
          </div>
          <button class="toggle-button" onclick="toggleDescription()">Show More</button>
        </div>
      </div>

      <!-- Related Stations Section -->
      <div>
        <h2>Related Stations</h2>
        <div class="row row-cols-1 g-3">
          <div class="col" th:each="relStation : ${related}">
            <a th:href="@{/stations/{name}(name=${relStation.formattedName})}" class="text-decoration-none">
              <div class="card h-100 shadow-sm related-station-card">
                <div class="card-body d-flex align-items-center">
                  <img th:src="${relStation.favicon}" th:alt="${relStation.name} + ' Logo'"
                    class="related-station-logo rounded me-3">
                  <p class="card-title mb-0" th:text="${relStation.name}">Related Station</p>
                </div>
              </div>
            </a>
          </div>
        </div>
      </div>
    </div>
    <div class="container main-section mt-3" id="relatedBlogsContainer">
      <h2 class="mb-4">Related Blogs</h2>
      <div class="accordion" id="blogAccordion">
        <div class="accordion-item border rounded-3" th:each="blog, iterStat : ${relatedBlogs}">
          <h2 class="accordion-header" th:id="'accordionHeader' + ${iterStat.index}">
            <button class="accordion-button fw-bold" type="button" data-bs-toggle="collapse"
              th:attr="data-bs-target='#collapse' + ${iterStat.index}"
              th:attrappend="aria-expanded=${iterStat.index == 0} ? 'true' : 'false'"
              th:aria-controls="'collapse' + ${iterStat.index}" th:text="${blog.title}">
              Blog Title
            </button>
          </h2>
          <div th:id="'collapse' + ${iterStat.index}" th:classappend="${iterStat.index == 0} ? 'show' : ''"
            class="accordion-collapse collapse" data-bs-parent="#blogAccordion">
            <div class="accordion-body">
              <div class="d-flex flex-column flex-md-row gap-3 align-items-start">
                <div class="img-wrapper flex-shrink-0">
                  <img th:src="${blog.faviconUrl}" th:alt="'eRadios.in | Blog: ' + ${blog.title}" width="120"
                    height="120" class="rounded border object-fit-cover">
                </div>
                <div>
                  <div class="small text-body" th:utext="${blog.content}">
                    Station description goes here.
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </section>

  <!-- Footer -->
  <footer class="bg-dark text-secondary py-4 mt-3">
    <div class="container">
      <!-- First Row: Description and Links -->
      <div class="row align-items-start">
        <!-- Description Column -->
        <div class="col-md-8 col-12 mb-3 mb-md-0">
          <small>
            <p>
              eRadios.in offers a wide variety of Indian radio stations for every taste and region. Stream Hindi, Tamil,
              Bengali, Telugu, Malayalam, Marathi and more, featuring music, news, and devotional content from India and
              around the globe. Access is completely free and mobile-friendly, with new stations added regularly.
              Discover the sounds of India — live, online, and anywhere.
            </p>
          </small>
        </div>
        <!-- Links Column -->
        <div class="col-md-4 col-12 text-md-end text-center">
          <ul class="list-unstyled">
            <li><a href="/privacy" class="text-secondary text-decoration-none">Privacy</a></li>
            <li><a href="/about" class="text-secondary text-decoration-none">About</a></li>
            <li><a href="/terms" class="text-secondary text-decoration-none">Terms</a></li>
            <li><a href="/blogs" class="text-secondary text-decoration-none">Blog</a></li>
            <li><a href="/terms#dmca" class="text-secondary text-decoration-none">DMCA</a></li>
            <li><a href="/terms#disclaimer" class="text-secondary text-decoration-none">Disclaimer</a></li>
            <li><a href="/terms#submission-terms" class="text-secondary text-decoration-none">Submission Terms</a></li>
          </ul>
        </div>
      </div>
      <!-- Second Row: Copyright -->
      <div class="row mt-3">
        <div class="col-12 text-center">
          <p class="mb-0 fs-6">&copy; 2025 eRadios.in</p>
        </div>
      </div>
    </div>
  </footer>

  <!-- Bootstrap JS -->
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
  <!-- Custom JS -->
  <!-- HLS.js must be loaded first -->
  <script src="https://cdn.jsdelivr.net/npm/hls.js@1.4.12/dist/hls.min.js"></script>

  <script th:inline="javascript">
    // Hide loader after DOM and audio are ready
    document.addEventListener('DOMContentLoaded', function () {
      // Wait for a short time to ensure all dynamic content is rendered
      setTimeout(function () {
        const loader = document.getElementById('pageLoader');
        if (loader) {
          loader.style.opacity = '0';
          setTimeout(() => loader.style.display = 'none', 400);
        }
      }, 400);
    });

    const player = document.createElement('audio');
    player.controls = false;
    document.body.appendChild(player);

    const playBtn = document.getElementById("play_btn");
    const streamUrl = /*[[${station.url_resolved}]]*/ '';
    const stationHomepage = /*[[${station.homepage}]]*/ '';

    let isHls = streamUrl.endsWith(".m3u8") || streamUrl.includes(".m3u8");

    function showLoader() {
      playBtn.innerHTML = `<i class="fas fa-spinner fa-spin"></i>`;
    }

    function showPlayIcon() {
      playBtn.innerHTML = `<i class="fas fa-play-circle"></i>`;
    }

    function showPauseIcon() {
      playBtn.innerHTML = `<i class="fas fa-pause-circle"></i>`;
    }

    function setupStream() {
      showLoader();

      if (isHls && Hls.isSupported()) {
        const hls = new Hls({ autoStartLoad: true });
        hls.loadSource(streamUrl);
        hls.attachMedia(player);
        hls.on(Hls.Events.MANIFEST_PARSED, () => {
          showPlayIcon();
        });
      } else if (isHls && player.canPlayType('application/vnd.apple.mpegurl')) {
        // Safari HLS support
        player.src = streamUrl;
        player.addEventListener('loadedmetadata', () => {
          showPlayIcon();
        });
      } else {
        // MP3, AAC, etc.
        player.src = streamUrl;
        player.addEventListener('canplay', () => {
          showPlayIcon();
        });
      }
    }

    setupStream();

    playBtn.addEventListener('click', () => {
      if (player.paused) {
        showLoader(); // Show loader while trying to play
        player.play().then(() => {
          showPauseIcon(); // Switch to pause after successful play
        }).catch(err => {
          console.warn("Playback failed:", err);

          if (isHls && Hls.isSupported()) {
            const hls = new Hls();
            hls.loadSource(streamUrl);
            hls.attachMedia(player);
            hls.on(Hls.Events.MANIFEST_PARSED, () => {
              player.play();
              showPauseIcon();
            });
          } else {
            alert('Cannot play stream. Opening in external player...');
            playBtn.innerHTML = `<a href="${stationHomepage}" target="_blank"><i class="play-icon fas fa-external-link-alt"></i></a>`;
          }
        });
      } else {
        player.pause();
        showPlayIcon(); // Switch back to play icon when paused
      }
    });
  </script>
  <script>
    function toggleDescription() {
      const description = document.getElementById('descriptionText');
      const button = document.querySelector('.toggle-button');

      if (description.classList.contains('expanded')) {
        description.classList.remove('expanded');
        button.textContent = 'Show More';
      } else {
        description.classList.add('expanded');
        button.textContent = 'Show Less';
      }
    }

    // Check if text is truncated to show/hide button
    window.addEventListener('load', () => {
      const description = document.getElementById('descriptionText');
      const button = document.querySelector('.toggle-button');
      const isTruncated = description.scrollHeight > description.clientHeight;

      button.style.display = isTruncated ? 'block' : 'none'; /* Hide button if no truncation */
    });
  </script>
  <script th:src="@{/js/scripts.js}"></script>
</body>

</html>